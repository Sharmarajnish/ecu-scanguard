/*
 * Real-World Automotive ECU Vulnerability Test Case
 * Based on actual CVE reports and security research
 * 
 * This file contains intentional vulnerabilities for testing purposes
 * DO NOT USE IN PRODUCTION SYSTEMS
 */


// Jeep Cherokee Uconnect Vulnerability (CVE-2015-7960)
// Real vulnerability: Remote code execution via cellular connection

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

// VULNERABLE: Hardcoded credentials in Uconnect system
const char* uconnect_password = "admin";
const char* root_password = "root";
const char* service_password = "service123";

// VULNERABLE: Command injection in cellular module
void process_cellular_command(const char* command) {
    char system_command[256];
    
    // VULNERABLE: Command injection
    sprintf(system_command, "cellular_exec %s", command);
    system(system_command);  // Real vulnerability in Jeep Uconnect
}

// VULNERABLE: Buffer overflow in message processing
void process_remote_message(char* message) {
    char local_buffer[128];
    
    // VULNERABLE: No bounds checking
    strcpy(local_buffer, message);
    
    // VULNERABLE: Stack overflow
    char large_buffer[1024];
    strcpy(large_buffer, local_buffer);
}

// VULNERABLE: Weak encryption keys
const char* encryption_key = "jeep_encrypt_2015";
const char* session_key = "uconnect_session";

// VULNERABLE: Predictable session tokens
int generate_session_token() {
    return rand() % 10000;  // Predictable random number
}

// VULNERABLE: No input validation
void handle_remote_request(char* request) {
    if (strstr(request, "engine_control")) {
        // VULNERABLE: Direct engine control without authentication
        control_engine_remotely();
    }
}
