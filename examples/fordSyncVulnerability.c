/*
 * Real-World Automotive ECU Vulnerability Test Case
 * Based on actual CVE reports and security research
 * 
 * This file contains intentional vulnerabilities for testing purposes
 * DO NOT USE IN PRODUCTION SYSTEMS
 */


// Ford SYNC Vulnerability
// Real vulnerability: Bluetooth stack buffer overflow

#include <stdio.h>
#include <string.h>
#include <bluetooth/bluetooth.h>

// VULNERABLE: Buffer overflow in Bluetooth message handling
void process_bluetooth_message(char* message) {
    char local_buffer[64];
    
    // VULNERABLE: No bounds checking
    strcpy(local_buffer, message);
    
    // VULNERABLE: Stack overflow
    char large_buffer[256];
    strcpy(large_buffer, local_buffer);
}

// VULNERABLE: Hardcoded Bluetooth PIN
const char* bluetooth_pin = "0000";
const char* pairing_key = "ford_sync_pairing";

// VULNERABLE: No authentication for SYNC commands
void execute_sync_command(const char* command) {
    if (strstr(command, "phone_book")) {
        // VULNERABLE: Access phone book without authentication
        access_phone_book();
    }
    
    if (strstr(command, "navigation")) {
        // VULNERABLE: Control navigation without authentication
        control_navigation();
    }
}

// VULNERABLE: Weak encryption in SYNC communication
void encrypt_sync_data(char* data) {
    // VULNERABLE: Simple XOR encryption
    char key = 0x42;
    for (int i = 0; i < strlen(data); i++) {
        data[i] ^= key;
    }
}

// VULNERABLE: No input validation in voice commands
void process_voice_command(char* command) {
    // VULNERABLE: No sanitization
    if (strstr(command, "call")) {
        char phone_number[32];
        sscanf(command, "call %s", phone_number);
        make_phone_call(phone_number);  // No validation
    }
}
