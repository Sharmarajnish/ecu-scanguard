import { Scan, Vulnerability, ComplianceResult, AnalysisLog } from '@/types/scan';

export const mockScans: Scan[] = [
  {
    id: '1',
    ecuName: 'JLR Engine Control Module v4.2',
    ecuType: 'Engine',
    version: '4.2.1-release',
    manufacturer: 'Bosch',
    fileHash: 'a1b2c3d4e5f6789012345678901234567890abcd',
    fileSize: 2048576,
    architecture: 'TriCore',
    status: 'complete',
    progress: 100,
    createdAt: new Date('2024-01-15T10:30:00'),
    completedAt: new Date('2024-01-15T11:45:00'),
    vulnerabilities: { critical: 2, high: 5, medium: 12, low: 8 },
    complianceScore: 78,
    riskScore: 65,
    executiveSummary: 'The Engine Control Module shows concerning security vulnerabilities, particularly in CAN message handling and cryptographic implementations. Immediate attention required for 2 critical vulnerabilities related to buffer overflows in diagnostic routines.',
  },
  {
    id: '2',
    ecuName: 'Transmission Control Unit v3.1',
    ecuType: 'Transmission',
    version: '3.1.0-beta',
    manufacturer: 'ZF',
    fileHash: 'b2c3d4e5f6789012345678901234567890abcde',
    fileSize: 1536000,
    architecture: 'PowerPC',
    status: 'analyzing',
    progress: 62,
    createdAt: new Date('2024-01-16T09:00:00'),
    vulnerabilities: { critical: 0, high: 3, medium: 7, low: 4 },
  },
  {
    id: '3',
    ecuName: 'Body Control Module v2.8',
    ecuType: 'BCM',
    version: '2.8.5',
    manufacturer: 'Continental',
    fileHash: 'c3d4e5f6789012345678901234567890abcdef',
    fileSize: 1024000,
    architecture: 'ARM',
    status: 'decompiling',
    progress: 35,
    createdAt: new Date('2024-01-16T14:20:00'),
    vulnerabilities: { critical: 0, high: 0, medium: 0, low: 0 },
  },
  {
    id: '4',
    ecuName: 'ADAS Sensor Fusion v1.5',
    ecuType: 'ADAS',
    version: '1.5.2-release',
    manufacturer: 'Mobileye',
    fileHash: 'd4e5f6789012345678901234567890abcdef01',
    fileSize: 4096000,
    architecture: 'ARM',
    status: 'queued',
    progress: 0,
    createdAt: new Date('2024-01-16T15:00:00'),
    vulnerabilities: { critical: 0, high: 0, medium: 0, low: 0 },
  },
  {
    id: '5',
    ecuName: 'Infotainment Head Unit v5.0',
    ecuType: 'Infotainment',
    version: '5.0.0',
    manufacturer: 'Harman',
    fileHash: 'e5f6789012345678901234567890abcdef0123',
    fileSize: 8192000,
    architecture: 'x86',
    status: 'complete',
    progress: 100,
    createdAt: new Date('2024-01-14T08:00:00'),
    completedAt: new Date('2024-01-14T10:30:00'),
    vulnerabilities: { critical: 4, high: 8, medium: 15, low: 22 },
    complianceScore: 62,
    riskScore: 82,
  },
];

export const mockVulnerabilities: Vulnerability[] = [
  {
    id: 'v1',
    scanId: '1',
    cveId: 'CVE-2024-1234',
    cweId: 'CWE-120',
    severity: 'critical',
    cvssScore: 9.8,
    title: 'Buffer Overflow in CAN Message Handler',
    description: 'A stack-based buffer overflow vulnerability exists in the CAN message processing routine. An attacker with access to the CAN bus can send specially crafted messages to execute arbitrary code.',
    affectedComponent: 'can_driver.c',
    affectedFunction: 'process_can_message()',
    codeSnippet: `void process_can_message(CAN_MSG* msg) {
    char buffer[64];
    memcpy(buffer, msg->data, msg->len); // No bounds check!
    parse_command(buffer);
}`,
    lineNumber: 142,
    detectionMethod: 'semgrep',
    status: 'new',
    remediation: 'Add bounds checking before memcpy. Validate msg->len does not exceed buffer size.',
    createdAt: new Date('2024-01-15T11:00:00'),
    updatedAt: new Date('2024-01-15T11:00:00'),
  },
  {
    id: 'v2',
    scanId: '1',
    cveId: 'CVE-2024-1235',
    cweId: 'CWE-321',
    severity: 'critical',
    cvssScore: 9.1,
    title: 'Hardcoded Cryptographic Key',
    description: 'The firmware contains a hardcoded AES-128 key used for secure boot validation. This allows attackers to sign malicious firmware updates.',
    affectedComponent: 'secure_boot.c',
    affectedFunction: 'verify_signature()',
    codeSnippet: `static const uint8_t AES_KEY[] = {
    0x2B, 0x7E, 0x15, 0x16, 0x28, 0xAE, 0xD2, 0xA6,
    0xAB, 0xF7, 0x15, 0x88, 0x09, 0xCF, 0x4F, 0x3C
};`,
    lineNumber: 28,
    detectionMethod: 'yara',
    status: 'new',
    remediation: 'Store cryptographic keys in secure hardware (HSM/TPM). Implement key derivation functions.',
    createdAt: new Date('2024-01-15T11:05:00'),
    updatedAt: new Date('2024-01-15T11:05:00'),
  },
  {
    id: 'v3',
    scanId: '1',
    cweId: 'CWE-306',
    severity: 'high',
    cvssScore: 8.1,
    title: 'Missing Seed-Key Authentication',
    description: 'Diagnostic services can be accessed without proper UDS seed-key authentication sequence.',
    affectedComponent: 'diag_handler.c',
    affectedFunction: 'handle_diagnostic_request()',
    lineNumber: 256,
    detectionMethod: 'semgrep',
    status: 'new',
    remediation: 'Implement proper seed-key authentication as per ISO 14229.',
    createdAt: new Date('2024-01-15T11:10:00'),
    updatedAt: new Date('2024-01-15T11:10:00'),
  },
  {
    id: 'v4',
    scanId: '1',
    cweId: 'CWE-338',
    severity: 'high',
    cvssScore: 7.5,
    title: 'Weak Random Number Generator',
    description: 'The firmware uses rand() for generating security-critical random values.',
    affectedComponent: 'crypto_utils.c',
    affectedFunction: 'generate_session_key()',
    codeSnippet: `uint32_t generate_session_key() {
    srand(time(NULL));
    return rand();
}`,
    lineNumber: 89,
    detectionMethod: 'capa',
    status: 'risk_accepted',
    remediation: 'Use hardware RNG or cryptographically secure PRNG.',
    createdAt: new Date('2024-01-15T11:15:00'),
    updatedAt: new Date('2024-01-15T14:00:00'),
  },
  {
    id: 'v5',
    scanId: '1',
    cweId: 'CWE-787',
    severity: 'high',
    cvssScore: 7.8,
    title: 'Out-of-bounds Write in Flash Handler',
    description: 'Flash write operations do not validate address boundaries.',
    affectedComponent: 'flash_driver.c',
    affectedFunction: 'write_flash_sector()',
    lineNumber: 312,
    detectionMethod: 'ghidra',
    status: 'new',
    createdAt: new Date('2024-01-15T11:20:00'),
    updatedAt: new Date('2024-01-15T11:20:00'),
  },
  {
    id: 'v6',
    scanId: '1',
    cweId: 'CWE-20',
    severity: 'medium',
    cvssScore: 6.5,
    title: 'Improper Input Validation in Parameter Handler',
    description: 'Configuration parameters are not validated before use.',
    affectedComponent: 'config_manager.c',
    affectedFunction: 'set_parameter()',
    lineNumber: 178,
    detectionMethod: 'semgrep',
    status: 'new',
    createdAt: new Date('2024-01-15T11:25:00'),
    updatedAt: new Date('2024-01-15T11:25:00'),
  },
];

export const mockComplianceResults: ComplianceResult[] = [
  {
    id: 'c1',
    scanId: '1',
    framework: 'MISRA C:2012',
    ruleId: 'Rule 17.7',
    ruleDescription: 'The value returned by a function having non-void return type shall be used',
    status: 'fail',
    details: 'Return value of memcpy ignored in 12 locations',
  },
  {
    id: 'c2',
    scanId: '1',
    framework: 'MISRA C:2012',
    ruleId: 'Rule 21.6',
    ruleDescription: 'The Standard Library input/output functions shall not be used',
    status: 'pass',
  },
  {
    id: 'c3',
    scanId: '1',
    framework: 'ISO 21434',
    ruleId: 'CAL-01',
    ruleDescription: 'Cryptographic algorithms shall be properly implemented',
    status: 'fail',
    details: 'Hardcoded keys detected, weak PRNG usage',
  },
  {
    id: 'c4',
    scanId: '1',
    framework: 'ISO 21434',
    ruleId: 'SEC-05',
    ruleDescription: 'Access control mechanisms shall be implemented',
    status: 'warning',
    details: 'Some diagnostic services lack proper authentication',
  },
  {
    id: 'c5',
    scanId: '1',
    framework: 'AUTOSAR',
    ruleId: 'SWS_Diag_00001',
    ruleDescription: 'Security Access service shall implement seed-key mechanism',
    status: 'fail',
  },
];

export const mockAnalysisLogs: AnalysisLog[] = [
  {
    id: 'l1',
    scanId: '1',
    stage: 'parsing',
    logLevel: 'info',
    message: 'Detected VBF format version 2.6',
    timestamp: new Date('2024-01-15T10:31:00'),
  },
  {
    id: 'l2',
    scanId: '1',
    stage: 'parsing',
    logLevel: 'info',
    message: 'Extracted 4 data blocks from container',
    timestamp: new Date('2024-01-15T10:32:00'),
  },
  {
    id: 'l3',
    scanId: '1',
    stage: 'decompiling',
    logLevel: 'info',
    message: 'Ghidra analysis started - TriCore architecture detected',
    timestamp: new Date('2024-01-15T10:35:00'),
  },
  {
    id: 'l4',
    scanId: '1',
    stage: 'decompiling',
    logLevel: 'warning',
    message: 'Unable to resolve 3 external symbol references',
    timestamp: new Date('2024-01-15T10:45:00'),
  },
  {
    id: 'l5',
    scanId: '1',
    stage: 'analyzing',
    logLevel: 'info',
    message: 'Running Semgrep with 47 automotive security rules',
    timestamp: new Date('2024-01-15T11:00:00'),
  },
  {
    id: 'l6',
    scanId: '1',
    stage: 'analyzing',
    logLevel: 'error',
    message: 'CRITICAL: Buffer overflow detected in CAN handler',
    timestamp: new Date('2024-01-15T11:05:00'),
  },
];

export const vulnerabilityTrends = [
  { date: '2024-01-08', critical: 8, high: 15, medium: 32, low: 45 },
  { date: '2024-01-09', critical: 7, high: 14, medium: 30, low: 42 },
  { date: '2024-01-10', critical: 9, high: 18, medium: 35, low: 48 },
  { date: '2024-01-11', critical: 6, high: 16, medium: 28, low: 40 },
  { date: '2024-01-12', critical: 8, high: 13, medium: 34, low: 52 },
  { date: '2024-01-13', critical: 5, high: 11, medium: 25, low: 38 },
  { date: '2024-01-14', critical: 10, high: 20, medium: 40, low: 55 },
  { date: '2024-01-15', critical: 6, high: 16, medium: 34, low: 44 },
];
